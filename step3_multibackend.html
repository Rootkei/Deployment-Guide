<!-- Step 3 -->
<div class="step-card">
    <div class="step-header">
        <div class="step-number">B∆∞·ªõc 3</div>
        <h4 class="step-title">Deploy Backend (Multi-Framework)</h4>
    </div>
    <div class="step-content">
        <p class="step-description">
            Clone code backend v√† c·∫•u h√¨nh ƒë·ªÉ ch·∫°y. Ch·ªçn framework ph√π h·ª£p v·ªõi d·ª± √°n c·ªßa b·∫°n.
        </p>

        <div class="code-tabs">
            <div class="code-tab-buttons">
                <button class="code-tab-btn active" data-tab="nodejs-be">Node.js</button>
                <button class="code-tab-btn" data-tab="dotnet-be">C# / .NET</button>
                <button class="code-tab-btn" data-tab="java-be">Java / Spring</button>
                <button class="code-tab-btn" data-tab="python-be">Python / Django</button>
                <button class="code-tab-btn" data-tab="golang-be">Go</button>
            </div>

            <!-- Node.js Tab -->
            <div class="code-tab-content active" data-tab="nodejs-be">
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">Bash - Node.js Backend</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <span class="copy-icon">üìã</span>
                            Copy
                        </button>
                    </div>
                    <pre><code># T·∫°o th∆∞ m·ª•c cho app
mkdir -p /home/ubuntu/apps
cd /home/ubuntu/apps

# Clone backend code
git clone https://github.com/your-username/backend-nodejs.git
cd backend-nodejs

# C√†i ƒë·∫∑t dependencies
npm install

# T·∫°o file .env
cat > .env << EOF
PORT=3000
NODE_ENV=production
DATABASE_URL=postgresql://user:pass@localhost:5432/dbname
JWT_SECRET=your-secret-key
EOF

# Start v·ªõi PM2
pm2 start npm --name "backend-api" -- start
pm2 save
pm2 startup

# Ki·ªÉm tra status
pm2 status
pm2 logs backend-api</code></pre>
                </div>
            </div>

            <!-- .NET Tab -->
            <div class="code-tab-content" data-tab="dotnet-be">
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">Bash - C# / .NET Backend</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <span class="copy-icon">üìã</span>
                            Copy
                        </button>
                    </div>
                    <pre><code># C√†i ƒë·∫∑t .NET SDK
wget https://dot.net/v1/dotnet-install.sh
chmod +x dotnet-install.sh
./dotnet-install.sh --channel 8.0

# Add to PATH
echo 'export PATH=$PATH:$HOME/.dotnet' >> ~/.bashrc
source ~/.bashrc

# Clone v√† build
cd /home/ubuntu/apps
git clone https://github.com/your-username/backend-dotnet.git
cd backend-dotnet

# Build
dotnet publish -c Release -o ./publish

# T·∫°o systemd service
sudo tee /etc/systemd/system/backend-api.service > /dev/null <<EOF
[Unit]
Description=ASP.NET Core Backend API

[Service]
WorkingDirectory=/home/ubuntu/apps/backend-dotnet/publish
ExecStart=/home/ubuntu/.dotnet/dotnet YourApp.dll
Restart=always
User=ubuntu
Environment=ASPNETCORE_ENVIRONMENT=Production

[Install]
WantedBy=multi-user.target
EOF

# Start service
sudo systemctl enable backend-api
sudo systemctl start backend-api
sudo systemctl status backend-api</code></pre>
                </div>
            </div>

            <!-- Java Tab -->
            <div class="code-tab-content" data-tab="java-be">
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">Bash - Java / Spring Boot Backend</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <span class="copy-icon">üìã</span>
                            Copy
                        </button>
                    </div>
                    <pre><code># C√†i ƒë·∫∑t Java 17 v√† Maven
sudo apt install -y openjdk-17-jdk maven

# Clone v√† build
cd /home/ubuntu/apps
git clone https://github.com/your-username/backend-java.git
cd backend-java

# Build v·ªõi Maven
mvn clean package -DskipTests

# T·∫°o systemd service
sudo tee /etc/systemd/system/backend-api.service > /dev/null <<EOF
[Unit]
Description=Spring Boot Backend API

[Service]
WorkingDirectory=/home/ubuntu/apps/backend-java
ExecStart=/usr/bin/java -jar target/app.jar --spring.profiles.active=prod
Restart=always
User=ubuntu

[Install]
WantedBy=multi-user.target
EOF

# Start service
sudo systemctl enable backend-api
sudo systemctl start backend-api
sudo journalctl -u backend-api -f</code></pre>
                </div>
            </div>

            <!-- Python Tab -->
            <div class="code-tab-content" data-tab="python-be">
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">Bash - Python / Django Backend</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <span class="copy-icon">üìã</span>
                            Copy
                        </button>
                    </div>
                    <pre><code># C√†i ƒë·∫∑t Python
sudo apt install -y python3 python3-pip python3-venv

# Clone v√† setup
cd /home/ubuntu/apps
git clone https://github.com/your-username/backend-python.git
cd backend-python

# Virtual environment
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt gunicorn

# Run migrations
python manage.py migrate
python manage.py collectstatic --noinput

# T·∫°o systemd service
sudo tee /etc/systemd/system/backend-api.service > /dev/null <<EOF
[Unit]
Description=Django Backend API

[Service]
WorkingDirectory=/home/ubuntu/apps/backend-python
Environment="PATH=/home/ubuntu/apps/backend-python/venv/bin"
ExecStart=/home/ubuntu/apps/backend-python/venv/bin/gunicorn --workers 3 --bind 0.0.0.0:8000 myproject.wsgi:application
Restart=always
User=ubuntu

[Install]
WantedBy=multi-user.target
EOF

# Start service
sudo systemctl enable backend-api
sudo systemctl start backend-api</code></pre>
                </div>
            </div>

            <!-- Go Tab -->
            <div class="code-tab-content" data-tab="golang-be">
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">Bash - Go Backend</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <span class="copy-icon">üìã</span>
                            Copy
                        </button>
                    </div>
                    <pre><code># C√†i ƒë·∫∑t Go
wget https://go.dev/dl/go1.21.5.linux-amd64.tar.gz
sudo rm -rf /usr/local/go
sudo tar -C /usr/local -xzf go1.21.5.linux-amd64.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.bashrc
source ~/.bashrc

# Clone v√† build
cd /home/ubuntu/apps
git clone https://github.com/your-username/backend-go.git
cd backend-go

# Build
go mod download
go build -o backend-api .

# T·∫°o systemd service
sudo tee /etc/systemd/system/backend-api.service > /dev/null <<EOF
[Unit]
Description=Go Backend API

[Service]
WorkingDirectory=/home/ubuntu/apps/backend-go
ExecStart=/home/ubuntu/apps/backend-go/backend-api
Restart=always
User=ubuntu
Environment="GIN_MODE=release"

[Install]
WantedBy=multi-user.target
EOF

# Start service
sudo systemctl enable backend-api
sudo systemctl start backend-api
sudo journalctl -u backend-api -f</code></pre>
                </div>
            </div>
        </div>

        <div class="info-box tip">
            <div class="info-icon">üí°</div>
            <div class="info-content">
                <strong>L∆∞u √Ω:</strong> ƒê·∫£m b·∫£o c·∫≠p nh·∫≠t Security Group ƒë·ªÉ m·ªü port t∆∞∆°ng ·ª©ng: 3000 (Node.js), 5000
                (.NET), 8080 (Java/Go), 8000 (Python).
            </div>
        </div>
    </div>
</div>